import { ChatInputCommandInteraction, SlashCommandBuilder } from "discord.js";
import { config } from "../config";
import { config } from "../config";
import { config } from "../config";
await interaction.channel?.send({

export default {
  data: new SlashCommandBuilder()
    .setName("say")
    .setDescription("El bot repite tu mensaje")
    .addStringOption(option =>
      option.setName("mensaje")
        .setDescription("El mensaje que quieres que repita")
        .setRequired(true)
    ),

  async execute(interaction: ChatInputCommandInteraction) {
    // Verificar si el usuario tiene permisos de administrador
    if (!interaction.memberPermissions?.has("Administrator")) {
      return interaction.reply({
        content: "❌ No tienes permisos para usar este comando.",
        ephemeral: true
      });
    }

    const mensaje = interaction.options.getString("mensaje", true);

    try {
      // Primero defer la interacción para tener más tiempo
      await interaction.deferReply();
      
      // Eliminar el reply y enviar el mensaje directamente al canal
      await interaction.channel?.send({
        content: mensaje,
        allowedMentions: { parse: [] }
      });
      
      // Eliminar el reply fantasma
      await interaction.deleteReply();
    } catch (error) {
      console.error("Error en comando say:", error);
      
      // Si ya hicimos defer, editamos la respuesta
      if (interaction.deferred) {
        await interaction.editReply({
          content: "❌ Error al enviar el mensaje."
        });
      } else {
        await interaction.reply({
          content: "❌ Error al enviar el mensaje.",
          ephemeral: true
        });
      }
    }
  }
};
